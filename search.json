[
  {
    "objectID": "website/index.html",
    "href": "website/index.html",
    "title": "Evaluation d‚Äôun mod√®le",
    "section": "",
    "text": "viewof username = secret(\"apiKey\", {\n  description:\n    \"This is your username for the API, it is only available to you!\",\n  submit: \"Set username\"\n})\n\n\n\n\n\n\n\nviewof password = secret(\"apiKey\", {\n  description:\n    \"This is your password for the API, it is only available to you!\",\n  submit: \"Set password\"\n})\n\n\n\n\n\n\n\nviewof csvfile = Inputs.file({\n  label: md`__Observations to evaluate__ üìÅ ([Example here](https://raw.githubusercontent.com/ThomasFaria/codif-ape-API/main/website/exemples/exemple.csv))`,\n  accept: \".csv\",\n  required: true\n})"
  },
  {
    "objectID": "website/index.html#connexion-√†-lapi-et-ajout-des-donn√©es",
    "href": "website/index.html#connexion-√†-lapi-et-ajout-des-donn√©es",
    "title": "Evaluation d‚Äôun mod√®le",
    "section": "",
    "text": "viewof username = secret(\"apiKey\", {\n  description:\n    \"This is your username for the API, it is only available to you!\",\n  submit: \"Set username\"\n})\n\n\n\n\n\n\n\nviewof password = secret(\"apiKey\", {\n  description:\n    \"This is your password for the API, it is only available to you!\",\n  submit: \"Set password\"\n})\n\n\n\n\n\n\n\nviewof csvfile = Inputs.file({\n  label: md`__Observations to evaluate__ üìÅ ([Example here](https://raw.githubusercontent.com/ThomasFaria/codif-ape-API/main/website/exemples/exemple.csv))`,\n  accept: \".csv\",\n  required: true\n})"
  },
  {
    "objectID": "website/index.html#distribution-des-indices-de-confiances",
    "href": "website/index.html#distribution-des-indices-de-confiances",
    "title": "Evaluation d‚Äôun mod√®le",
    "section": "Distribution des indices de confiances",
    "text": "Distribution des indices de confiances\n\ngrid = await html`&lt;div style=\"\n              background: #fff;\n              margin: 0;\n              border: none ;\n              display: grid;\n              width: ${screen.width};\n              grid-template-areas:\n                'a b c'\n                'd d d'\n                ;\n              grid-gap: 10px;\n            \"&gt;\n              &lt;div name=\"a\" style=\"grid-area: a; position: relative;\"&gt;${viewof quantile}&lt;/div&gt;\n              &lt;div name=\"b\" style=\"grid-area: b; position: relative;\"&gt;&lt;div class=\"textstyled\"&gt;Accuracy: ${Accuracy}&lt;/div&gt;&lt;/div&gt;\n              &lt;div name=\"c\" style=\"grid-area: c; position: relative;\"&gt;&lt;div class=\"textstyled\"&gt;Seuil: ${Seuil}&lt;/div&gt;&lt;/div&gt;\n              &lt;div name=\"d\" style=\"grid-area: d; position: relative;\"&gt;${distrib}&lt;/div&gt;\n            &lt;/div&gt;`\n\n\n\n\n\n\n\nviewof quantile = slider({\n  min: 0,\n  max: 100,\n  step: 1,\n  value: 80,\n  format: (v) =&gt; `${v}%`,\n  description: \"Taux de classification automatique\"\n})\n\n\n\n\n\n\n\ndistrib = Plot.plot({\n  round: true,\n  width: screen.width * 0.7,\n  color: { scheme: \"BuRd\", legend: true },\n  marks: [\n    Plot.rectY(\n      processed_response,\n      Plot.binX(\n        { y: \"count\" },\n        { x: \"IC\", fill: \"Result\", mixBlendMode: \"multiply\", tip: true }\n      )\n    ),\n    Plot.ruleY([0]),\n    Plot.ruleX([Seuil], { strokeWidth: 2, tip: true })\n  ]\n})\n\n\n\n\n\n\n\nSeuil = Math.round(\n  d3.quantile(\n    processed_response.map((d) =&gt; d.IC),\n    1 - quantile / 100\n  ) * 100\n) / 100\n\n\n\n\n\n\n\nAccuracy = Math.round(d3.mean(subset.map((d) =&gt; d.IC)) * 10000) / 100\n\n\n\n\n\n\n\nInputs.table(processed_response)"
  },
  {
    "objectID": "website/index.html#liste-des-mauvaises-predictions",
    "href": "website/index.html#liste-des-mauvaises-predictions",
    "title": "Evaluation d‚Äôun mod√®le",
    "section": "Liste des mauvaises predictions",
    "text": "Liste des mauvaises predictions\n\nWrongPredictions = Inputs.table(subset.filter((d) =&gt; 1 - d.Result))\n\n\n\n\n\n\n\n\ndata = db.query(\n  `\nSELECT text_description, type_, nature, surface, event, code\nFROM liasses\n`\n)\n\n\n\n\n\n\n\ntransformedData = data.reduce((acc, obj) =&gt; {\n  for (const [key, value] of Object.entries(obj)) {\n    if (!acc.hasOwnProperty(key)) {\n      acc[key] = [];\n    }\n    acc[key].push(value);\n  }\n  return acc;\n}, {})\n\n\n\n\n\n\n\ndb = DuckDBClient.of({\n  liasses: await csvfile.csv()\n})\n\n\n\n\n\n\n\nprocessed_response = Object.keys(response.IC).map((key) =&gt; ({\n  IC: response.IC[key] &gt; 1 ? 1 - 1e-16 : response.IC[key],\n  Probability: response.Probability[key],\n  Prediction: response.Prediction[key],\n  Code: response.Code[key],\n  Result: response.Result[key],\n  Lib: response.Lib[key]\n}))\n\n\n\n\n\n\n\nresponse = queryBatchApi(username, password, data)\n\n\n\n\n\n\n\nsubset = processed_response.filter((d) =&gt; d.IC &gt; Seuil)\n\n\n\n\n\n\n\n\nasync function queryBatchApi(username, password, data) {\n  const url = \"https://codification-ape.lab.sspcloud.fr/evaluation\";\n\n  // Create the request body\n  const request_body = data.reduce((acc, obj) =&gt; {\n    for (const [key, value] of Object.entries(obj)) {\n      if (!acc.hasOwnProperty(key)) {\n        acc[key] = [];\n      }\n      acc[key].push(value);\n    }\n    return acc;\n  }, {});\n\n  const response = await fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Basic ${btoa(`${username}:${password}`)}`\n    },\n    body: JSON.stringify(request_body)\n  });\n\n  if (response.ok) {\n    return response.json();\n  } else if (response.status === 400) {\n    console.log((await response.json()).detail);\n  } else {\n    console.log(\"Error occurred while querying the API.\");\n    return response;\n  }\n}\n\n\n\n\n\n\n\n\nimport { secret } from \"@tmcw/secret\"\n\n\n\n\n\n\n\nimport {slider} from \"@jashkenas/inputs\"\n\n\n\n\n\n\n\nPlot = require(\"https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6.8/dist/plot.umd.min.js\")\n\n\n\n\n\n\n\nhtml`&lt;style&gt;\n  @import\n  url('https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap');\n\n.title {\n  font-family: Roboto;\n  font-weight:bold;\n  font-size:30px;\n  color:white;\n  border-radius: 20px;\n  background: #1D3867;\n  width: 200px;\n  height: 45px;\n  margin: auto;\n  width: 100%;\n  padding-top: 10px;\n  padding-bottom: 15px;\n  text-align: center;\n  }\n\n.textstyled {\n  left: 0px;\n  font-family: Roboto;\n  font-weight:bold;\n  font-size:15px;\n  color:white;\n  border-radius: 15px;\n  background: #1D3867;\n  height: 15px;\n  margin: auto;\n  width: fit-content;\n  padding-left: 10px;\n  padding-right: 10px;\n  padding-top: 5px;\n  padding-bottom: 25px;\n}\n&lt;/style&gt;`"
  },
  {
    "objectID": "website/lmnp.html",
    "href": "website/lmnp.html",
    "title": "LMNP",
    "section": "",
    "text": "text_description\ntype_\nnature\nsurface\nevent\nTrue\nPr√©diction\nScore\nLibell√©\nError\n\n\n\n\n0\nLOUEUR EN MEUBLE NON PROFESSIONNEL\n\n\n\n\n6820A\n6820A\n0.999556\nLocation de logements\nTrue\n\n\n1\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nL\n\n\n\n6820A\n6820A\n0.995280\nLocation de logements\nTrue\n\n\n2\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nE\n\n\n\n6820A\n6820A\n0.967061\nLocation de logements\nTrue\n\n\n3\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nX\n\n\n\n6820A\n6820A\n0.992815\nLocation de logements\nTrue\n\n\n4\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nS\n\n\n\n6820A\n6820A\n0.847198\nLocation de logements\nTrue\n\n\n5\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nI\n\n\n\n6820A\n6820A\n1.000000\nLocation de logements\nTrue\n\n\n6\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nC\n\n\n\n5520Z\n5520Z\n0.830647\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n7\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nR\n\n\n\n5520Z\n6820A\n0.558918\nLocation de logements\nFalse\n\n\n8\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nG\n\n\n\n5520Z\n5520Z\n0.418262\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n9\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nD\n\n\n\n5520Z\n6820A\n0.936932\nLocation de logements\nFalse\n\n\n10\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nY\n\n\n\n5520Z\n5520Z\n0.416244\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n11\nLOUEUR MEUBLE NON PROFESSIONNEL\n\n\n\n\n6820A\n6820A\n0.999556\nLocation de logements\nTrue\n\n\n12\nLOUEUR MEUBLE NON PROFESSIONNEL\nL\n\n\n\n6820A\n6820A\n0.995280\nLocation de logements\nTrue\n\n\n13\nLOUEUR MEUBLE NON PROFESSIONNEL\nE\n\n\n\n6820A\n6820A\n0.967061\nLocation de logements\nTrue\n\n\n14\nLOUEUR MEUBLE NON PROFESSIONNEL\nX\n\n\n\n6820A\n6820A\n0.992815\nLocation de logements\nTrue\n\n\n15\nLOUEUR MEUBLE NON PROFESSIONNEL\nS\n\n\n\n6820A\n6820A\n0.847198\nLocation de logements\nTrue\n\n\n16\nLOUEUR MEUBLE NON PROFESSIONNEL\nI\n\n\n\n6820A\n6820A\n1.000000\nLocation de logements\nTrue\n\n\n17\nLOUEUR MEUBLE NON PROFESSIONNEL\nC\n\n\n\n5520Z\n5520Z\n0.830647\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n18\nLOUEUR MEUBLE NON PROFESSIONNEL\nR\n\n\n\n5520Z\n6820A\n0.558918\nLocation de logements\nFalse\n\n\n19\nLOUEUR MEUBLE NON PROFESSIONNEL\nG\n\n\n\n5520Z\n5520Z\n0.418262\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n20\nLOUEUR MEUBLE NON PROFESSIONNEL\nD\n\n\n\n5520Z\n6820A\n0.936932\nLocation de logements\nFalse\n\n\n21\nLOUEUR MEUBLE NON PROFESSIONNEL\nY\n\n\n\n5520Z\n5520Z\n0.416244\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n22\nLMNP\n\n\n\n\n6820A\n6820A\n1.000000\nLocation de logements\nTrue\n\n\n23\nLMNP\nL\n\n\n\n6820A\n6820A\n0.993710\nLocation de logements\nTrue\n\n\n24\nLMNP\nE\n\n\n\n6820A\n6820A\n0.998824\nLocation de logements\nTrue\n\n\n25\nLMNP\nX\n\n\n\n6820A\n6820A\n0.986774\nLocation de logements\nTrue\n\n\n26\nLMNP\nS\n\n\n\n6820A\n6820A\n0.955319\nLocation de logements\nTrue\n\n\n27\nLMNP\nI\n\n\n\n6820A\n6820A\n1.000000\nLocation de logements\nTrue\n\n\n28\nLMNP\nC\n\n\n\n5520Z\n5520Z\n0.999290\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n29\nLMNP\nR\n\n\n\n5520Z\n6820A\n0.939913\nLocation de logements\nFalse\n\n\n30\nLMNP\nG\n\n\n\n5520Z\n6820A\n0.829982\nLocation de logements\nFalse\n\n\n31\nLMNP\nD\n\n\n\n5520Z\n6820A\n0.960361\nLocation de logements\nFalse\n\n\n32\nLMNP\nY\n\n\n\n5520Z\n6820A\n0.791605\nLocation de logements\nFalse"
  },
  {
    "objectID": "website/lmnp.html#lmnp",
    "href": "website/lmnp.html#lmnp",
    "title": "LMNP",
    "section": "",
    "text": "text_description\ntype_\nnature\nsurface\nevent\nTrue\nPr√©diction\nScore\nLibell√©\nError\n\n\n\n\n0\nLOUEUR EN MEUBLE NON PROFESSIONNEL\n\n\n\n\n6820A\n6820A\n0.999556\nLocation de logements\nTrue\n\n\n1\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nL\n\n\n\n6820A\n6820A\n0.995280\nLocation de logements\nTrue\n\n\n2\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nE\n\n\n\n6820A\n6820A\n0.967061\nLocation de logements\nTrue\n\n\n3\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nX\n\n\n\n6820A\n6820A\n0.992815\nLocation de logements\nTrue\n\n\n4\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nS\n\n\n\n6820A\n6820A\n0.847198\nLocation de logements\nTrue\n\n\n5\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nI\n\n\n\n6820A\n6820A\n1.000000\nLocation de logements\nTrue\n\n\n6\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nC\n\n\n\n5520Z\n5520Z\n0.830647\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n7\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nR\n\n\n\n5520Z\n6820A\n0.558918\nLocation de logements\nFalse\n\n\n8\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nG\n\n\n\n5520Z\n5520Z\n0.418262\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n9\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nD\n\n\n\n5520Z\n6820A\n0.936932\nLocation de logements\nFalse\n\n\n10\nLOUEUR EN MEUBLE NON PROFESSIONNEL\nY\n\n\n\n5520Z\n5520Z\n0.416244\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n11\nLOUEUR MEUBLE NON PROFESSIONNEL\n\n\n\n\n6820A\n6820A\n0.999556\nLocation de logements\nTrue\n\n\n12\nLOUEUR MEUBLE NON PROFESSIONNEL\nL\n\n\n\n6820A\n6820A\n0.995280\nLocation de logements\nTrue\n\n\n13\nLOUEUR MEUBLE NON PROFESSIONNEL\nE\n\n\n\n6820A\n6820A\n0.967061\nLocation de logements\nTrue\n\n\n14\nLOUEUR MEUBLE NON PROFESSIONNEL\nX\n\n\n\n6820A\n6820A\n0.992815\nLocation de logements\nTrue\n\n\n15\nLOUEUR MEUBLE NON PROFESSIONNEL\nS\n\n\n\n6820A\n6820A\n0.847198\nLocation de logements\nTrue\n\n\n16\nLOUEUR MEUBLE NON PROFESSIONNEL\nI\n\n\n\n6820A\n6820A\n1.000000\nLocation de logements\nTrue\n\n\n17\nLOUEUR MEUBLE NON PROFESSIONNEL\nC\n\n\n\n5520Z\n5520Z\n0.830647\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n18\nLOUEUR MEUBLE NON PROFESSIONNEL\nR\n\n\n\n5520Z\n6820A\n0.558918\nLocation de logements\nFalse\n\n\n19\nLOUEUR MEUBLE NON PROFESSIONNEL\nG\n\n\n\n5520Z\n5520Z\n0.418262\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n20\nLOUEUR MEUBLE NON PROFESSIONNEL\nD\n\n\n\n5520Z\n6820A\n0.936932\nLocation de logements\nFalse\n\n\n21\nLOUEUR MEUBLE NON PROFESSIONNEL\nY\n\n\n\n5520Z\n5520Z\n0.416244\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n22\nLMNP\n\n\n\n\n6820A\n6820A\n1.000000\nLocation de logements\nTrue\n\n\n23\nLMNP\nL\n\n\n\n6820A\n6820A\n0.993710\nLocation de logements\nTrue\n\n\n24\nLMNP\nE\n\n\n\n6820A\n6820A\n0.998824\nLocation de logements\nTrue\n\n\n25\nLMNP\nX\n\n\n\n6820A\n6820A\n0.986774\nLocation de logements\nTrue\n\n\n26\nLMNP\nS\n\n\n\n6820A\n6820A\n0.955319\nLocation de logements\nTrue\n\n\n27\nLMNP\nI\n\n\n\n6820A\n6820A\n1.000000\nLocation de logements\nTrue\n\n\n28\nLMNP\nC\n\n\n\n5520Z\n5520Z\n0.999290\nH√©bergement touristique et autre h√©bergement d...\nTrue\n\n\n29\nLMNP\nR\n\n\n\n5520Z\n6820A\n0.939913\nLocation de logements\nFalse\n\n\n30\nLMNP\nG\n\n\n\n5520Z\n6820A\n0.829982\nLocation de logements\nFalse\n\n\n31\nLMNP\nD\n\n\n\n5520Z\n6820A\n0.960361\nLocation de logements\nFalse\n\n\n32\nLMNP\nY\n\n\n\n5520Z\n6820A\n0.791605\nLocation de logements\nFalse"
  }
]